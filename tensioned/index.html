<!DOCTYPE html>
<head>
    <meta http-equiv="Content-Language" content="en">
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta charset="UTF-8">
    <title>DiBL - Bobbin lace working diagrams for grounds</title>
    <link href="colorpicker/mcColorPicker.css" rel="stylesheet" type="text/css" />
    <script src="colorpicker/mcColorPicker.js" type="text/javascript"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.5/d3.min.js"></script>
    <script src="show-graph.js"></script>
    <script src="sample.js"></script>
    <script src="matrix-graphs.js"></script>
    <script>
      function show(form) {
        document.getElementById('diagram').innerHTML = ""
        var data = dibl.D3Data().get(form.set.value, form.nrInSet.value * 1, form.rows.value * 1, form.cols.value * 1)
        showGraph({
          threadColor: '#colorpicker',
          container: '#diagram',
          width: form.width.value,
          height: form.height.value,
          nodes: data.nodes,
          links: data.links,
        })
      }
      function setMax(form) {
        form.nrInSet.max = form.set[form.set.selectedIndex].getAttribute("data-max-nr")
      }
    </script>
   <style>
        input { width: 3em; }
        #threadColor input { width: 4.5em; }
        label, form { display: inline-block; }
        .node {
          fill: #000;
          opacity: 0;
        }
        .node.fixed {
          fill: #90f;
        }
        svg {vertical-align: text-top}

        /* size relates to dy-attribute of svg.selectAll(".labelText") in the script */
        .labelText {font-size:9px; font-weight: bold; }
    </style>
</head>
<body>
    <img align="right" src="../logo-big.png" width="104" height="96"/>
    <h1>Bobbin lace working diagrams</h1>
    <p><em>Under construction</em>: <a href="https://github.com/jo-pol/DiBL/labels/enhancement"
    >wish list</a>, see also the previous diagram generator based on <a href="http://jo-pol.github.io/DiBL/grounds"
       >templates</a> for thread diagrams.
    </p>
    <ul><li>
      Drag pins to fix their position, single click to release.
    </li><li>
      Hover over form fields or diagram components for tooltips: the stitch in terms of t(wist)c(cross)
        + spreadsheet like coordinates matching a brick wise stacked pattern matrix.
    </li><li>
      The diagrams might be rotated, mirrored or twisted: dragging can fix that.
      A fast move may (un)twist or flip a diagram. Two twists can become a flip too.
    </li><li>
      FireFox, Chrome and Safari are fine, IE has a <a href="https://connect.microsoft.com/IE/feedback/details/801938/dynamically-updated-svg-path-with-a-marker-end-does-not-update"
      >problem</a> rendering the color codes of pair diagrams and over-under effect of thread diagrams.
    </li><li>
        <label form="graph">Try another pattern: </label>
        <form id="graph" action="" onsubmit="show(this); return false">
            <label for="set">set</label>
            <select size="1" id="set" name="set" onChange="setMax(form)" title="matrices with configuration of stitch connections">
                <option data-max-nr="6">2x2</option>
                <option data-max-nr="92">4x2</option>
                <option data-max-nr="46" selected>2x4</option>
            </select>
            <label for="nrInSet">nr in set</label>
            <input id="nrInSet" name="nrInSet" min="0" max="46" value="3" type="number" title="matrix with configuration of stitch connections"/>

            <label for="rows">rows</label>
            <input id="rows" name="rows" min="0" max="20" value="8" type="number" title="number of stitches"/>
            <label for="cols">columns</label>
            <input id="cols" name="cols" min="0" max="20" value="5" type="number" title="number of stitches"/>

            <label for="width">width</label>
            <input id="width" name="width" min="200" max="999" value="300" type="number" title="number of pixels"/>
            <label for="height">height</label>
            <input id="height" name="height" min="200" max="999" value="300" type="number" title="number of pixels"/>

            <button class="button" type="submit">draw</button>
        </form>
    </li><li> 
        <form id="threadColor" action="" onsubmit="return false;">
            <label for="colorpicker">
              Single click the square start of a thread to paint it:
            </label>
            <input id="colorpicker" type="text" class="color" value="#CC0000" title="color to apply to a thread by clicking its start"/>
        </form>
    </li></ul>
    <div id="diagram"></div>
    <script>
      showGraph({
        threadColor: '#colorpicker',
        container: '#diagram',
        width: 300,
        height: 300,
        nodes: sample.nodes,
        links: sample.links,
      })
    </script>
    <p><a href="https://github.com/jo-pol/DiBL/commits/gh-pages/tensioned/"
       >Changes</a>. <a href="https://github.com/jo-pol/DiBL/tree/gh-pages/tensioned"
       >Source code</a>, contributions are welcome. Powered by: <a href="https://d3js.org"
       >D3.js</a>, <a href="http://www.menucool.com/color-picker"
       >Menucool</a>.
    </p>
</body>