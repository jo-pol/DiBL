<!DOCTYPE html>
<head>
    <meta http-equiv="Content-Language" content="en">
    <meta http-equiv="content-type" content="text/html; charset=UTF-8">
    <meta charset="UTF-8">
    <title>DiBL - Bobbin lace working diagrams for grounds</title>
    <link href="colorpicker/mcColorPicker.css" rel="stylesheet" type="text/css" />
    <script src="colorpicker/mcColorPicker.js" type="text/javascript"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/d3/3.5.5/d3.min.js"></script>
    <script src="show-graph.js"></script>
    <script src="sample.js"></script>
    <script src="matrix-graphs.js"></script>
    <script>
      function show(form) {
        var data = dibl.D3Data().get(
          form.set.value,
          form.nrInSet.value * 1,
          form.rows.value * 1,
          form.cols.value * 1,
          form.shiftLeft.value * 1,
          form.shiftUp.value * 1,
          form.stitches.value
          )
        document.getElementById('diagram').innerHTML = ""
        showGraph({
          threadColor: '#colorpicker',
          container: '#diagram',
          width: form.pairWidth.value * 1,
          height: form.pairHeight.value * 1,
          nodes: data.nodes,
          links: data.links,
        })
        showGraph({
          threadColor: '#colorpicker',
          container: '#diagram',
          width: form.threadWidth.value * 1,
          height: form.threadHeight.value * 1,
          nodes: data.threadNodes,
          links: data.threadLinks,
        })
      }
      function setMax(form) {
        form.nrInSet.max = form.set[form.set.selectedIndex].getAttribute("data-max-nr")
      }
      function init() {
        showGraph({
          threadColor: '#colorpicker',
          container: '#diagram',
          width: 300,
          height: 468,
          nodes: sample.nodes,
          links: sample.links,
        })
      }
    </script>
   <style>
     input { width: 3em; }
     #threadColor input { width: 4.5em; }
     form, #diagram { display: inline-block; }
     fieldset { margin-bottom: 0.4em; padding-bottom: 0.3em }
     svg{ border: solid 1px #AAA; margin-right: 0.4em; }
     .node {
       fill: #000;
       opacity: 0;
     }
     .node.fixed {
       fill: #90f;
     }

     /* size relates to dy-attribute of svg.selectAll(".labelText") in the script */
     .labelText {font-size:9px; font-weight: bold; }
    </style>
</head>
<body onload="init()">
    <img align="right" src="../logo-big.png"/>
    <h1>Bobbin lace working diagrams</h1>
    <p><em>Under construction</em>: <a href="https://github.com/jo-pol/DiBL/labels/enhancement"
    >wish list</a>, the numbering in the NxM pattern sets is the same as for the <a href="http://jo-pol.github.io/DiBL/grounds/"
    >interleaved</a> patterns based on templates but different from the <a href="http://web.uvic.ca/%7Evmi/papers/interleavedpatterns.html"
    >original data</a>.
    </p>
    <ul><li>
      Hover over diagram components for tooltips: description, hint and/or
        the stitch in terms of t(wist)c(cross) + spreadsheet like coordinates
        matching a brick wise stacked pattern matrix.
    </li><li>
      The diagrams might be rotated, mirrored or twisted: dragging can fix that.
      A fast move may (un)twist or flip a diagram. Two twists can become a flip too.
    </li><li>
      FireFox, Chrome and Safari are fine, IE has a <a href="https://connect.microsoft.com/IE/feedback/details/801938/dynamically-updated-svg-path-with-a-marker-end-does-not-update"
      >problem</a> rendering the color codes of pair diagrams and over-under effect of thread diagrams.
    </li><li>
        <form id="threadColor" action="" onsubmit="return false;">
            <label for="colorpicker">
                Single click the square start of a thread to paint it:
            </label>
            <input id="colorpicker" type="text" class="color" value="#CC0000"/>
        </form>
    </li></ul>
    <form id="graph" action="" onsubmit="return false">

        <label for="pattern">Try another pattern </label>
        <fieldset id="pattern">
            <label for="nrInSet">nr</label>
            <input id="nrInSet" name="nrInSet" min="0" max="2" value="0" type="number"/>
            <label for="set">in set</label>
            <select size="1" id="set" name="set" onChange="setMax(form)">
                <option data-max-nr="3" value="2x4 torchon">torchon</option>
                <option data-max-nr="2" value="2x4 bias">bias</option>
                <option data-max-nr="0" value="2x4 paris/kat">paris/kat</option>
                <option data-max-nr="1" value="2x4 cloth">cloth</option>
                <option data-max-nr="0" value="2x4 vrouwkens">vrouwkens</option>
                <option data-max-nr="1" value="2x4 small snowflakes">small snowflakes</option>
                <option data-max-nr="2" value="2x4 rose ground" selected>rose ground</option>
                <option data-max-nr="6">2x2</option>
                <option data-max-nr="92">4x2</option>
                <option data-max-nr="46">2x4</option>
            </select>
        </fieldset>

        <label for="st">Stitches</label>
        <fieldset id="st">
            <textarea rows="3" cols="30" id="stitches" name="stitches"
            >A1=tc, B1=tctc, C1=tc, D1=tctc, A2=tc, B2=tc, C2=tc, D2=tc</textarea>
            <br/>c(ross) t(wist) l(eft-twist) r(ight-twist) p(in)
            <br/>compare with tooltips in the diagrams
        </fieldset>

        <label for="shift">Shift (stitches)</label>
        <fieldset id="shift">
            <label for="shiftLeft">footside by </label>
            <input id="shiftLeft" name="shiftLeft" min="0" max="3" value="0" type="number"/>
            <label for="shiftUp">top by </label>
            <input id="shiftUp" name="shiftUp" min="0" max="3" value="0" type="number"/>
        </fieldset>

        <label for="patchSize">Patch size (stitches) </label>
        <fieldset id="patchSize">
            <label for="rows">rows</label>
            <input id="rows" name="rows" min="0" max="20" value="6" type="number"/>
            <label for="cols">columns</label>
            <input id="cols" name="cols" min="0" max="20" value="7" type="number"/>
        </fieldset>

        <label for="pairImage">Pair image size (pixels)</label>
        <fieldset id="pairImage">
            <label for="pairWidth">width</label>
            <input id="pairWidth" name="pairWidth" min="200" max="999" value="280" type="number"/>
            <label for="pairHeight">height</label>
            <input id="pairHeight" name="pairHeight" min="200" max="999" value="468" type="number"/>
        </fieldset>

        <label for="threadImage">Thread image size (pixels)</label>
        <fieldset id="threadImage">
            <label for="threadWidth">width</label>
            <input id="threadWidth" name="threadWidth" min="200" max="999" value="350" type="number"/>
            <label for="threadHeight">height</label>
            <input id="threadHeight" name="threadHeight" min="200" max="999" value="468" type="number"/>
        </fieldset>

        <button class="button" onclick="show(this.form); return false">draw</button>
    </form>
    <div id="diagram"></div>
    <p><a href="https://github.com/jo-pol/DiBL/tree/gh-pages/tensioned#how-its-made"
       >How it's made</a> - <a href="https://github.com/jo-pol/DiBL/tree/gh-pages/tensioned#how-to-contribute"
       >Changes</a> - Powered by: <a href="https://d3js.org"
       >D3.js</a>, <a href="http://www.menucool.com/color-picker"
       >Menucool</a>.
    </p>
</body>
